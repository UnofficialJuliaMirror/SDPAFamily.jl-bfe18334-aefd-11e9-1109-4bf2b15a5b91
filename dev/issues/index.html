<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Possible Issues &amp; Troubleshooting · SDPAFamily.jl</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/></head><body><nav class="toc"><h1>SDPAFamily.jl</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../">Home</a></li><li><a class="toctext" href="../installation/">Installation</a></li><li><a class="toctext" href="../usage/">Usage</a></li><li><a class="toctext" href="../examples/">Examples</a></li><li class="current"><a class="toctext" href>Possible Issues &amp; Troubleshooting</a><ul class="internal"><li><a class="toctext" href="#Underflows-1">Underflows</a></li><li><a class="toctext" href="#Presolve-1">Presolve</a></li><li><a class="toctext" href="#Choice-of-parameters-1">Choice of parameters</a></li><li><a class="toctext" href="#Summary-of-problematic-problems-1">Summary of problematic problems</a></li><li><a class="toctext" href="#Troubleshooting-1">Troubleshooting</a></li></ul></li><li><a class="toctext" href="../reference/">Developer reference</a></li></ul></nav><article id="docs"><header><nav><ul><li><a href>Possible Issues &amp; Troubleshooting</a></li></ul><a class="edit-page" href="https://github.com/ericphanson/SDPAFamily.jl/blob/master/docs/src/issues.md#L"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Possible Issues &amp; Troubleshooting</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Possible-Issues-and-Troubleshooting-1" href="#Possible-Issues-and-Troubleshooting-1">Possible Issues and Troubleshooting</a></h1><p>We now demonstrate some current limitations of this package via <a href="https://github.com/ericphanson/Convex.jl/tree/MathOptInterface"><code>Convex.jl#MathOptInterface</code></a>&#39;s <code>Problem Deopt</code>. This is run with <code>TEST=true</code>, meaning the solution returned by the solver will be tested against the true solution.</p><h2><a class="nav-anchor" id="Underflows-1" href="#Underflows-1">Underflows</a></h2><p>This occurs when the precision used to represent the solution is not high enough compared to the internal precision used by the solver. This lack of precision can lead to catastrophic cancellation. In the following, SDPA-QD is used to solve the problem, and <code>Float64</code> numbers are used to represent the obtained solution, and the test fails.</p><div></div><pre><code class="language-julia-repl">julia&gt; test_problem = Convex.ProblemDepot.PROBLEMS[&quot;affine&quot;][&quot;affine_Diagonal_atom&quot;];

julia&gt; TEST = true; atol = 1e-3; rtol = 0.0;

julia&gt; test_problem(Val(TEST), atol, rtol, Float64) do problem
           solve!(problem, SDPAFamily.Optimizer{Float64}(variant=:sdpa_qd, silent=true))
       end
Test Failed at /home/travis/.julia/packages/Convex/r4w0m/src/problem_depot/problems/affine.jl:498
  Expression: all(abs.(evaluate(Diagonal(x)) - Diagonal([1, 2, 3, 4])) .&lt;= atol)
ERROR: There was an error during testing</code></pre><p>We try to automatically detect underflows and warn against them; in this case, the warning is issued. Sometimes this can be avoided by choosing a better set of parameters. See <a href="#Choice-of-parameters-1">Choice of parameters</a>.</p><h2><a class="nav-anchor" id="Presolve-1" href="#Presolve-1">Presolve</a></h2><p>The usefulness of our <code>presolve</code> routine is demonstrated in <a href="../usage/#Using-presolve-1">Using presolve</a>. However, our <code>presolve</code> subroutine does not utilize any tools more powerful than naïve Gaussian elimination and it has limitations. At its core, the <code>reduce!</code> method takes in a sparse matrix where each row is a linearized constraint matrix and apply Gaussian elimination with pivoting to identify the linear independence. This process is not numerically stable as the rounding errors accumulate as we progress. Therefore, we cannot guarantee that all linear dependent entries will be identified. </p><p>This is demonstrated in the following example. For a <span>$1500 \times 100$</span> matrix (Here we use one more column because <code>reduce!</code> ignores the last column as it represents the constraint constants. They go along for the ride here to help us identify <em>inconsistent</em> constraints.), we expect <span>$1400$</span> or more linearly dependent rows. However, due to its numerical instability, we can only identify a subset of them.</p><pre><code class="language-julia-repl">julia&gt; A = sprandn(1500, 101, 0.1);

julia&gt; redundant_F = collect(setdiff!(Set(1:1500), Set(rowvals(SDPAFamily.reduce!(A)[:, 1:end-1]))));

julia&gt; length(redundant_F)
1400</code></pre><h2><a class="nav-anchor" id="Choice-of-parameters-1" href="#Choice-of-parameters-1">Choice of parameters</a></h2><p>Unfortunately, we have not been able to successfully solve every problem that we have tried with one choice of parameters. We have chosen default parameter settings that we hope will work with a wide variety of problems. See <a href="../usage/#Usage-1">Usage</a> for details on switching to two other sets of parameters provided by the solvers.</p><p>This is an example where a better choice of parameters can help.</p><pre><code class="language-julia-repl">julia&gt; test_problem = Convex.ProblemDepot.PROBLEMS[&quot;lp&quot;][&quot;lp_dotsort_atom&quot;];

julia&gt; TEST = true; atol = 1e-3; rtol = 0.0;

julia&gt; test_problem(Val(TEST), atol, rtol, Float64) do problem
           solve!(problem, SDPAFamily.Optimizer{Float64}(variant=:sdpa_dd, silent=true))
       end
┌ Warning: Problem status INFEASIBLE_OR_UNBOUNDED; solution may be inaccurate.
└ @ Convex ~/.julia/packages/Convex/r4w0m/src/MOI_solve.jl:199
Test Failed at /home/travis/.julia/packages/Convex/r4w0m/src/problem_depot/problems/lp.jl:203
  Expression: ≈(p.optval, 19, atol=atol, rtol=rtol)
   Evaluated: 18.916736239293826 ≈ 19 (atol=0.001, rtol=0.0)
ERROR: There was an error during testing</code></pre><pre><code class="language-julia-repl">julia&gt; test_problem = Convex.ProblemDepot.PROBLEMS[&quot;lp&quot;][&quot;lp_dotsort_atom&quot;];

julia&gt; TEST = true; atol = 1e-3; rtol = 0.0;

julia&gt; test_problem(Val(TEST), atol, rtol, Float64) do problem
           solve!(problem, SDPAFamily.Optimizer{Float64}(variant=:sdpa_dd, silent=true, params = UNSTABLE_BUT_FAST))
       end
ERROR: UndefVarError: UNSTABLE_BUT_FAST not defined</code></pre><h2><a class="nav-anchor" id="Summary-of-problematic-problems-1" href="#Summary-of-problematic-problems-1">Summary of problematic problems</a></h2><p>Due to the above reasons, we have modified the default settings for the following tests from <code>Convex.jl</code>&#39;s `Problem Depot&#39;.</p><table><tr><th style="text-align: left">Solver</th><th style="text-align: left">Underflow</th><th style="text-align: left">Need to use <code>params = UNSTABLE_BUT_FAST</code></th><th style="text-align: left">Presolve disabled due to long runtime</th></tr><tr><td style="text-align: left"><code>:sdpa_dd</code></td><td style="text-align: left"><code>affine_Partial_transpose</code></td><td style="text-align: left"><code>affine_Partial_transpose</code> <code>lp_pos_atom</code> <code>lp_neg_atom</code> <code>sdp_matrix_frac_atom</code> <code>lp_dotsort_atom</code></td><td style="text-align: left"><code>affine_Partial_transpose</code> <code>lp_min_atom</code> <code>lp_max_atom</code></td></tr><tr><td style="text-align: left"><code>:sdpa_qd</code></td><td style="text-align: left"><code>affine_Partial_transpose</code> <code>affine_Diagonal_atom</code></td><td style="text-align: left"><code>affine_Partial_transpose</code> <code>affine_Diagonal_atom</code></td><td style="text-align: left"><code>affine_Partial_transpose</code> <code>lp_min_atom</code> <code>lp_max_atom</code></td></tr><tr><td style="text-align: left"><code>:sdpa_gmp</code></td><td style="text-align: left"><code>affine_Partial_transpose</code></td><td style="text-align: left"><code>affine_Partial_transpose</code></td><td style="text-align: left"><code>affine_Partial_transpose</code> <code>lp_min_atom</code> <code>lp_max_atom</code></td></tr></table><p>In addition, we have excluded <code>lp_dotsort_atom</code> and <code>lp_pos_atom</code> when testing <code>:sdpa</code> due to imprecise solutions using default parameters. We have also excluded all second-order cone problems when using <code>BigFloat</code> or <code>Double64</code> numeric types, due to MathOptInterface.jl#876, as well as the <code>sdp_lambda_max_atom</code> problem due to GenericLinearAlgebra#47.</p><h2><a class="nav-anchor" id="Troubleshooting-1" href="#Troubleshooting-1">Troubleshooting</a></h2><p>When the solvers fail to return a solution, we recommend trying out the following troubleshoot steps.</p><ol><li>Set <code>silent=false</code> and look for warnings and error messages. If necessary, check the output file. Its path is printed by the solver output and can also be retrieved via <code>Optimizer.tempdir</code>.</li><li>Set <code>presolve=true</code> to remove redundant constraints. Typically, redundant constraints are indicated by a premature <code>cholesky miss</code> error as shown above.</li><li>Use <code>BigFloat</code> (the default) or <code>Double64</code> (from the <a href="https://github.com/JuliaMath/DoubleFloats.jl">DoubleFloats</a> package) precision instead of <code>Float64</code> (e.g. <code>SDPAFamily.Optimizer{Double64}(...)</code>). This will reduce the chance of having underflow errors when reading back the results.</li><li>Change the parameters by passing a custom parameter file (i.e. <code>SDPAFamily.Optimizer(params=...)</code>). <a href="https://sourceforge.net/projects/sdpa/files/sdpa/sdpa.7.1.1.manual.20080618.pdf">SDPA users manual</a> contains two other sets of parameters, <code>UNSTABLE_BUT_FAST</code> and <code>STABLE_BUT_SLOW</code>, which can be set by the <code>params</code> argument. It might also be helpful to use a tighter <code>epsilonDash</code> and <code>epsilonStar</code> tolerance in a custom params file.</li></ol><footer><hr/><a class="previous" href="../examples/"><span class="direction">Previous</span><span class="title">Examples</span></a><a class="next" href="../reference/"><span class="direction">Next</span><span class="title">Developer reference</span></a></footer></article></body></html>
